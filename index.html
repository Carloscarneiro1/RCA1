<!DOCTYPE html> 
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RELAT√ìRIO DE ATENDIMENTO √Ä CLIENTES (RAC)</title>

<style>
*{box-sizing:border-box;}

body{
font-family:Arial,Helvetica,sans-serif;
margin:0;
padding:0;
background:#f3f4f6;
color:#1f2933;
}

header{
width:100%;
background:#f97316;
color:#ffffff;
padding:18px 0;
text-align:center;
font-size:20px;
font-weight:bold;
letter-spacing:0.5px;
}

.area-strip{background:#f97316;padding:0 16px;}
.area-title{
background:#f97316;
color:#ffffff;
padding:12px 24px;
font-size:16px;
border-bottom-right-radius:22px;
display:inline-block;
font-weight:bold;
}

.section-container{
max-width:960px;
margin:0 auto 24px;
background:#ffffff;
padding:24px 32px 32px;
border-radius:0 0 12px 12px;
box-shadow:0 6px 18px rgba(0,0,0,0.08);
border-top:1px solid #e5e7eb;
}

.section-header{margin-bottom:22px;}
.section-header h2{
margin:0;
font-size:20px;
font-weight:600;
color:#1f2933;
}
.title-underline{
width:80px;
height:3px;
border-radius:999px;
background:#f97316;
margin-top:6px;
}

.field{margin-bottom:22px;}
.field-title{
font-size:14px;
margin-bottom:4px;
color:#374151;
font-weight:600;
text-transform:uppercase;
}
.required{color:#e53935;font-weight:bold;margin-left:2px;}

.md-input{
position:relative;
display:flex;
align-items:center;
background:#f5f5f5;
border-radius:8px;
border:1px solid #d1d5db;
padding:10px 12px 6px;
}

.md-input input,
.md-input textarea,
.md-input select{
width:100%;
border:none;
background:transparent;
outline:none;
padding:10px 0 4px;
font-size:14px;
color:#111827;
}

.md-input textarea{
resize:vertical;
min-height:60px;
}

.md-arrow{
position:absolute;
right:12px;
top:50%;
transform:translateY(-50%);
font-size:14px;
color:#757575;
pointer-events:none;
}

.preview-container{
margin-top:8px;
display:flex;
flex-wrap:wrap;
gap:8px;
}
.preview-item{
position:relative;
width:120px;
height:120px;
}
.preview-item img{
width:100%;
height:100%;
object-fit:cover;
border-radius:6px;
border:2px solid #f97316;
}

.delete-btn{
position:absolute;
top:-6px;
right:-6px;
background:#e53935;
color:#fff;
font-size:12px;
font-weight:bold;
width:20px;
height:20px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
cursor:pointer;
}

.btn{
display:inline-block;
padding:10px 20px;
border-radius:999px;
border:none;
cursor:pointer;
font-size:14px;
font-weight:600;
margin-left:8px;
transition:.1s ease;
}
.btn-primary{background:#f97316;color:#fff;}
.btn-primary:hover{background:#d55f10;}
.btn-secondary{background:#e5e7eb;color:#111827;}

@media(max-width:768px){
.section-container{margin:0 8px 16px;padding:20px 16px 24px;}
}
</style>
</head>

<body>

<div id="rac-container">
<header>RELAT√ìRIO DE ATENDIMENTO √Ä CLIENTES (RAC)</header>

<!-- √ÅREA 1 -->
<div class="area-strip"><div class="area-title">√Årea 1</div></div>

<div class="section-container">
<div class="section-header">
<h2>Dados gerais</h2>
<div class="title-underline"></div>
</div>

<div class="field">
<div class="field-title">Data da visita<span class="required">*</span></div>
<div class="md-input"><input type="date" id="dataVisita"></div>
</div>

<div class="field">
<div class="field-title">Nome do analista<span class="required">*</span></div>
<div class="md-input">
<input id="analista" list="listaAnalistas" placeholder="Digite para pesquisar">
<datalist id="listaAnalistas">
<option value="Leandro Nogueira"></option>
<option value="Mayara Rodrigues"></option>
<option value="Celso Penteado"></option>
<option value="Carlos Carneiro"></option>
</datalist>
<span class="md-arrow">‚ñæ</span>
</div>
</div>

<div class="field">
<div class="field-title">Nome do cliente</div>
<div class="md-input"><input type="text" id="nomeCliente"></div>
</div>

<div class="field">
<div class="field-title">Cidade / Estado</div>
<div class="md-input"><input type="text" id="cidadeEstado"></div>
</div>
</div>

<!-- √ÅREA 2 -->
<div class="area-strip"><div class="area-title">√Årea 2</div></div>

<div class="section-container">
<div class="section-header">
<h2>Dados da reclama√ß√£o</h2>
<div class="title-underline"></div>
</div>

<div class="field">
<div class="field-title">N√∫mero(s) RO</div>
<div class="md-input"><input type="text" id="numeroRo"></div>
</div>

<div class="field">
<div class="field-title">Quantidade total reclamada (m¬≤)</div>
<div class="md-input"><input type="number" step="0.01" id="qtdReclamada"></div>
</div>

<div class="field">
<div class="field-title">Defeito reclamado<span class="required">*</span></div>
<div class="md-input">
<select id="defeitoReclamado">
<option value="" disabled selected hidden>Selecione</option>
<option>DEFEITOS PONTUAIS</option>
<option>DIFICULDADE NO CORTE / EMPENAMENTO</option>
<option>FALTA DE CHAPAS</option>
<option>MANCHAS/IRISA√á√ÉO</option>
<option>RISCO</option>
<option>VIDRO MOLHADO</option>
<option>DESLOCAMENTO DE CHAPAS</option>
<option>PRODUTO ERRADO</option>
</select>
<span class="md-arrow">‚ñæ</span>
</div>
</div>

<div class="field">
<div class="field-title">Perguntas relacionadas ao defeito</div>
<div id="perguntasDefeito" style="font-size:12px;color:#666;">Selecione um defeito para exibir as perguntas.</div>
</div>

<div class="field">
<div class="field-title">Observa√ß√µes</div>
<div class="md-input">
<textarea id="obsReclamacao" rows="3"></textarea>
</div>
<div class="attach-row" style="margin-top:6px;">
üìé ANEXAR (AT√â 10) <br>
<input type="file" id="anexoObs" multiple accept="image/*">
</div>
<div id="previewObs" class="preview-container"></div>
</div>
</div>

<!-- √ÅREA 3 -->
<div class="area-strip"><div class="area-title">√Årea 3</div></div>

<div class="section-container">
<div class="section-header">
<h2>An√°lise t√©cnica</h2>
<div class="title-underline"></div>
</div>

<div class="field">
<div class="field-title">Coment√°rios gerais referente ao atendimento</div>
<div class="md-input">
<textarea id="comentariosGerais" rows="3"></textarea>
</div>
<div class="attach-row" style="margin-top:6px;">
üìé ANEXAR (AT√â 10) <br>
<input type="file" id="anexoAnaliseTecnica" multiple accept="image/*">
</div>
<div id="previewAnaliseTecnica" class="preview-container"></div>
</div>
</div>

<div class="section-container">
<div style="text-align:right;">
<button class="btn btn-secondary">Registrar</button>
<button class="btn btn-primary" onclick="gerarPDF()">Exportar PDF</button>
</div>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<script>

const perguntas = {
"DEFEITOS PONTUAIS":[
"FOI ENCONTRADO ANTES OU DEPOIS DO PROCESSAMENTO?",
"HOUVE APROVEITAMENTO DA CHAPA?",
"O DEFEITO √â VISTO EM TODAS AS CHAPAS?",
"QUAL A QUANTIDADE DE DEFEITOS?",
"QUAL FOI A PERCA REAL?",
"TEM AMOSTRAS SEGREGADAS PARA ENVIO?"
],

"DIFICULDADE NO CORTE / EMPENAMENTO":[
"A APLICA√á√ÉO DO √ìLEO DE CORTE EST√Å NORMAL?",
"A PRESS√ÉO DA FERRAMENTA FOI AJUSTADA?",
"H√Å PROBLEMAS NO DESTAQUE?",
"MESA DE CORTE EM BOAS CONDI√á√ïES?",
"O MATERIAL EST√Å SEGREGADO?",
"QUAL PRESS√ÉO UTILIZADA?",
"QUAL FOI A PERDA REAL?",
"QUAL O √ÇNGULO DO ROD√çZIO?",
"TEMPO DE TROCA DOS ROD√çZIOS?",
"TODAS AS CHAPAS QUEBRAM NO CORTE?",
"FOI REALIZADA MEDI√á√ÉO DO EMPENAMENTO? VALOR?",
"MATERIAL PROCESSADO? HOUVE PERDA? M¬≤?",
"TODAS AS CHAPAS COM EMPENAMENTO?",
"O MATERIAL EST√Å SEGREGADO?"
],

"FALTA DE CHAPAS":[
"A FALTA FOI VISTA NO DESCARREGAMENTO?",
"POSSUI RIE? ENVIAR C√ìPIA",
"QUANTAS CHAPAS FALTAM?"
],

"MANCHAS/IRISA√á√ÉO":[
"IND√çCIO DE √ÅGUA NAS PILHAS?",
"HOUVE BENEFICIAMENTO DO LOTE?",
"O MATERIAL EST√Å SEGREGADO?",
"QUAL FOI A PERDA REAL?",
"TODAS AS CHAPAS COM MANCHAS?"
],

"RISCO":[
"√â POSS√çVEL SENTIR O RISCO?",
"BANHO OU ATMOSFERA?",
"CONT√çNUO OU INTERMITENTE?",
"BASE OU PRODUTO ACABADO?",
"CROQUI?",
"SENTIDO DO RISCO?"
],

"VIDRO MOLHADO":[
"AVARIA NA LONA?",
"PROCESSAMENTO R√ÅPIDO?",
"HOUVE PERDA?",
"TODAS AS CHAPAS MOLHADAS?"
],

"DESLOCAMENTO DE CHAPAS":[
"DESN√çVEL EM TODAS AS CHAPAS?",
"DESN√çVEL NAS EXTREMIDADES?",
"EVID√äNCIAS DE MEDI√á√ïES?",
"MATERIAL PROCESSADO? PERDA M¬≤?"
],

"PRODUTO ERRADO":[]
};

document.getElementById("defeitoReclamado").addEventListener("change",()=>{
const defeito=document.getElementById("defeitoReclamado").value;
const box=document.getElementById("perguntasDefeito");
box.innerHTML="";
const lista=perguntas[defeito]||[];
lista.length===0?box.innerHTML="<i style='font-size:12px;color:#777;'>Sem perguntas cadastradas</i>": 
lista.forEach(p=>{box.innerHTML+=`
<div class='field'>
<div class='field-title'>${p}</div>
<div class='md-input'><textarea rows='2'></textarea></div>
</div>`});
});

// PREVIEW + EXCLUIR
function setupPreview(inputId, previewId){
const input=document.getElementById(inputId);
const preview=document.getElementById(previewId);
let imagens=[];

function render(){
preview.innerHTML="";
imagens.forEach((file,i)=>{
const reader=new FileReader();
reader.onload=e=>{
const div=document.createElement("div");
div.className="preview-item";

const img=document.createElement("img");
img.src=e.target.result;

const del=document.createElement("div");
del.className="delete-btn";
del.innerText="√ó";
del.onclick=()=>{imagens.splice(i,1);render();};

div.appendChild(img);
div.appendChild(del);
preview.appendChild(div);
};
reader.readAsDataURL(file);
});
}

input.addEventListener("change",()=>{
Array.from(input.files).forEach(f=>{
if(f.type.startsWith("image/") && imagens.length<10){
imagens.push(f);
}
});
render();
});
}

setupPreview("anexoObs","previewObs");
setupPreview("anexoAnaliseTecnica","previewAnaliseTecnica");

// PDF
async function gerarPDF(){
const{jsPDF}=window.jspdf;
const area=document.getElementById("rac-container");
const canvas=await html2canvas(area,{scale:2});
const img=canvas.toDataURL("image/png");
const pdf=new jsPDF("p","pt","a4");
const pageW=pdf.internal.pageSize.getWidth();
const pageH=pdf.internal.pageSize.getHeight();
const imgH=canvas.height*pageW/canvas.width;
let pos=0,left=imgH;
pdf.addImage(img,"PNG",0,pos,pageW,imgH);
left-=pageH;
while(left>0){
pos-=pageH;
pdf.addPage();
pdf.addImage(img,"PNG",0,pos,pageW,imgH);
left-=pageH;
}
pdf.save("RAC.pdf");
}
</script>

</body>
</html>
